<?php

/**
 * @file
 * The main Islandora Metadata Extras module file.
 */

/**
 * Implements hook_menu().
 */
function islandora_metadata_extras_menu() {
  $items = array();
  $items['admin/islandora/tools/metadata_extras'] = array(
    'title' => 'Metadata Extras',
    'description' => 'Configure the Islandora Metadata Extras module.',
    'page callback' => 'drupal_get_form',
    'access arguments' => array('administer site configuration'),
    'page arguments' => array('islandora_metadata_extras_admin_form'),
    'file' => 'includes/admin.form.inc',
    'type' => MENU_NORMAL_ITEM,
  );
  return $items;
}

/**
 * Implements hook_islandora_solr_object_result_alter().
 */
function islandora_metadata_extras_islandora_solr_object_result_alter(&$search_result, $query_processor) {
  if (variable_get('islandora_metadata_extras_use_collection_label', FALSE)) {
    module_load_include('inc', 'islandora_metadata_extras', 'includes/utilities');
    $collection_field = variable_get('islandora_solr_member_of_collection_field', 'RELS_EXT_isMemberOfCollection_uri_ms');
    if (isset($search_result['solr_doc'][$collection_field])) {
      foreach ($search_result['solr_doc'][$collection_field] as $collection_pid) {
        $search_result['solr_doc'][$collection_field] = islandora_metadata_extras_pid_to_label($collection_pid);
      }
    }
  }
}
